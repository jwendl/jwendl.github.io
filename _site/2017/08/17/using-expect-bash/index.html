<!DOCTYPE html> <html> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no"> <title>Using Expect with Bash &#8211; Justin Wendlandt's Blog</title> <meta name="description" content="Most command line applications in Linux use parameters to take arguments in, similar to the following example.user@pc:~$ mycommand --parameter valueWhat happens in the situation when the command asks for a prompt? It makes it difficult to utilize that command in a shell script, because there is no way to redirect input into it. For instance, &lt; or | would fail.user@pc:~$ mycommand &lt; echo &quot;value we want to pass&quot;­The above example fails primarily because it’s really passing the value to the input stream of the command not a prompt on the command line. One way to work around this issue is to use a library called Expect. Expect can be installed on Ubuntu using apt-get.user@pc:~$ apt-get install expectOnce the expect application is installed, it can be used by creating a “recording” of a session. So if our “mycommand” application above prompted for a value, we could then write a macro script to pass data into the prompted value.expect &lt;&lt;- DONE set timeout -1 spawn mycommand --parameter value expect &quot;?hat&#39;s your name:*&quot; send -- &quot;Justin\r&quot; send -- &quot;\r&quot; expect eofDONEBreaking down the steps above. The set timeout -1 line just tells expect to instantly put the value when it detects the prompt. If it’s set to any value above 0, then that is the time in seconds it delays before putting the value in.The next command is the “spawn” command. This executes your application and any command line parameters that need to be used for the application.The expect statement below that is the prompt that we want to take action on. In our example, it might prompt the text “What’s your name:” and our regex above, the ‘?’ just is a character wildcard.The next send statements below that will pass that text key by key into the prompt on linux.The final statement expect eof tells expect that the macro session is over and it can move on to any other commands in the shell script.Hopefully, the use cases for this are pretty rare. When you do run into this situation though, it’s good to know that there is a way to work around passing values into an input prompt for bash shell scripting."> <meta name="keywords" content="bash, linux"> <!-- Twitter Cards --> <meta name="twitter:card" content="summary"> <meta name="twitter:image" content="halve.png"> <meta name="twitter:title" content="Using Expect with Bash"> <meta name="twitter:description" content="Most command line applications in Linux use parameters to take arguments in, similar to the following example.user@pc:~$ mycommand --parameter valueWhat happens in the situation when the command asks for a prompt? It makes it difficult to utilize that command in a shell script, because there is no way to redirect input into it. For instance, &lt; or | would fail.user@pc:~$ mycommand &lt; echo &quot;value we want to pass&quot;­The above example fails primarily because it’s really passing the value to the input stream of the command not a prompt on the command line. One way to work around this issue is to use a library called Expect. Expect can be installed on Ubuntu using apt-get.user@pc:~$ apt-get install expectOnce the expect application is installed, it can be used by creating a “recording” of a session. So if our “mycommand” application above prompted for a value, we could then write a macro script to pass data into the prompted value.expect &lt;&lt;- DONE set timeout -1 spawn mycommand --parameter value expect &quot;?hat&#39;s your name:*&quot; send -- &quot;Justin\r&quot; send -- &quot;\r&quot; expect eofDONEBreaking down the steps above. The set timeout -1 line just tells expect to instantly put the value when it detects the prompt. If it’s set to any value above 0, then that is the time in seconds it delays before putting the value in.The next command is the “spawn” command. This executes your application and any command line parameters that need to be used for the application.The expect statement below that is the prompt that we want to take action on. In our example, it might prompt the text “What’s your name:” and our regex above, the ‘?’ just is a character wildcard.The next send statements below that will pass that text key by key into the prompt on linux.The final statement expect eof tells expect that the macro session is over and it can move on to any other commands in the shell script.Hopefully, the use cases for this are pretty rare. When you do run into this situation though, it’s good to know that there is a way to work around passing values into an input prompt for bash shell scripting."> <meta name="twitter:site" content="@jwendl"> <meta name="twitter:creator" content="@jwendl"> <!-- Open Graph --> <meta property="og:locale" content="en_US"> <meta property="og:type" content="article"> <meta property="og:title" content="Using Expect with Bash"> <meta property="og:description" content="Most command line applications in Linux use parameters to take arguments in, similar to the following example.user@pc:~$ mycommand --parameter valueWhat happens in the situation when the command asks for a prompt? It makes it difficult to utilize that command in a shell script, because there is no way to redirect input into it. For instance, &lt; or | would fail.user@pc:~$ mycommand &lt; echo &quot;value we want to pass&quot;­The above example fails primarily because it’s really passing the value to the input stream of the command not a prompt on the command line. One way to work around this issue is to use a library called Expect. Expect can be installed on Ubuntu using apt-get.user@pc:~$ apt-get install expectOnce the expect application is installed, it can be used by creating a “recording” of a session. So if our “mycommand” application above prompted for a value, we could then write a macro script to pass data into the prompted value.expect &lt;&lt;- DONE set timeout -1 spawn mycommand --parameter value expect &quot;?hat&#39;s your name:*&quot; send -- &quot;Justin\r&quot; send -- &quot;\r&quot; expect eofDONEBreaking down the steps above. The set timeout -1 line just tells expect to instantly put the value when it detects the prompt. If it’s set to any value above 0, then that is the time in seconds it delays before putting the value in.The next command is the “spawn” command. This executes your application and any command line parameters that need to be used for the application.The expect statement below that is the prompt that we want to take action on. In our example, it might prompt the text “What’s your name:” and our regex above, the ‘?’ just is a character wildcard.The next send statements below that will pass that text key by key into the prompt on linux.The final statement expect eof tells expect that the macro session is over and it can move on to any other commands in the shell script.Hopefully, the use cases for this are pretty rare. When you do run into this situation though, it’s good to know that there is a way to work around passing values into an input prompt for bash shell scripting."> <meta property="og:url" content="http://localhost:4000/2017/08/17/using-expect-bash/"> <meta property="og:site_name" content="Justin Wendlandt's Blog"> <meta property="og:image" content="http://localhost:4000/images/halve.png"> <link rel="canonical" href="http://localhost:4000/2017/08/17/using-expect-bash/"> <!-- Handheld --> <meta name="HandheldFriendly" content="True"> <meta name="MobileOptimized" content="320"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- Feed --> <link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Justin Wendlandt's Blog" /> <!-- Favicons --> <link rel="shortcut icon" type="image/png" href="http://localhost:4000/favicon.png" /> <link rel="shortcut icon" href="http://localhost:4000/favicon.ico" /> <!-- CSS --> <link rel="stylesheet" type="text/css" href="http://localhost:4000/assets/css/main.css"> <!-- Left Block Image for Posts --> <style type="text/css"> #posts.inner-post-page .block-left {background: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url(http://localhost:4000/images/unsplash-gallery-image-3.jpg) no-repeat;background-size: cover;} </style> <!-- Left Block Images for Home and Pages --> <style type="text/css"> #posts .block-left {background: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url(http://localhost:4000/images/unsplash-image-10.jpg) no-repeat;background-size: cover, cover;} .block-left {background: linear-gradient(rgba(44,45,51,0.9), rgba(44,45,51,0.9)), url(http://localhost:4000/images/home.png) no-repeat;background-size: cover;} </style> </head> <body id="posts" class="inner-post-page"> <div class="block-left"> <div class="content"> <a href="http://localhost:4000" class="logo"><img src="http://localhost:4000/images/halve.png"></a> <div class="post-title-section"> <div class="section-line">Posts <em>/</em></div> <h1 class="section-title">Using Expect with Bash </h1> <ul class="tags"> <li><a href="http://localhost:4000/tags#bash">bash</a></li> <li><a href="http://localhost:4000/tags#linux">linux</a></li> </ul> <div class="section-line reverse"><a href="http://localhost:4000/posts">Back to posts</a> <em>/</em></div> </div> </div> </div> <div class="block-right"> <div class="share-buttons"> <a href="https://twitter.com/intent/tweet?text=http://localhost:4000/2017/08/17/using-expect-bash/" class="btn btn_twitter" title="Share on Twitter"><i class="fa fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a> <a href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:4000/2017/08/17/using-expect-bash/" class="btn btn_facebook" title="Share on Facebook"><i class="fa fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a> <a href="https://plus.google.com/share?url=http://localhost:4000/2017/08/17/using-expect-bash/" class="btn btn_google-plus" title="Share on Google Plus"><i class="fa fa-fw fa-google-plus" aria-hidden="true"></i><span> Google+</span></a> </div> <a href="http://localhost:4000/posts.html" title="posts" class="posts-menu-icon"></a> <a title="http://localhost:4000/projects" class="projects-menu-icon"> <span></span> </a> <div class="inner-post content"> <div class="date-highlight">17 Aug 2017</div> <p>Most command line applications in Linux use parameters to take arguments in, similar to the following example.</p> <figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="gp">user@pc:~$ </span>mycommand --parameter value</code></pre></figure> <p>What happens in the situation when the command asks for a prompt? It makes it difficult to utilize that command in a shell script, because there is no way to redirect input into it. For instance, &lt; or | would fail.</p> <figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="gp">user@pc:~$ </span>mycommand &lt; <span class="nb">echo</span> <span class="s2">"value we want to pass"</span></code></pre></figure> <p>­</p> <p>The above example fails primarily because it’s really passing the value to the input stream of the command not a prompt on the command line. One way to work around this issue is to use a library called <a href="https://packages.ubuntu.com/search?keywords=expect">Expect</a>. Expect can be installed on Ubuntu using apt-get.</p> <figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="gp">user@pc:~$ </span>apt-get install expect</code></pre></figure> <p>Once the expect application is installed, it can be used by creating a “recording” of a session. So if our “mycommand” application above prompted for a value, we could then write a macro script to pass data into the prompted value.</p> <figure class="highlight"><pre><code class="language-bash" data-lang="bash">expect <span class="sh">&lt;&lt;- DONE
	set timeout -1

	spawn mycommand --parameter value

	expect "?hat's your name:*"
	send -- "Justin\r"
	send -- "\r"

	expect eof
</span><span class="err">DONE</span></code></pre></figure> <p>Breaking down the steps above. The set timeout -1 line just tells expect to instantly put the value when it detects the prompt. If it’s set to any value above 0, then that is the time in seconds it delays before putting the value in.</p> <p>The next command is the “spawn” command. This executes your application and any command line parameters that need to be used for the application.</p> <p>The expect statement below that is the prompt that we want to take action on. In our example, it might prompt the text “What’s your name:” and our regex above, the ‘?’ just is a character wildcard.</p> <p>The next send statements below that will pass that text key by key into the prompt on linux.</p> <p>The final statement expect eof tells expect that the macro session is over and it can move on to any other commands in the shell script.</p> <p>Hopefully, the use cases for this are pretty rare. When you do run into this situation though, it’s good to know that there is a way to work around passing values into an input prompt for bash shell scripting.</p> <br /> <a href="https://twitter.com/intent/tweet?text=http://localhost:4000/2017/08/17/using-expect-bash/" class="btn btn_twitter" title="Share on Twitter"><i class="fa fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a> <a href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:4000/2017/08/17/using-expect-bash/" class="btn btn_facebook" title="Share on Facebook"><i class="fa fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a> <a href="https://plus.google.com/share?url=http://localhost:4000/2017/08/17/using-expect-bash/" class="btn btn_google-plus" title="Share on Google Plus"><i class="fa fa-fw fa-google-plus" aria-hidden="true"></i><span> Google+</span></a> <div id="page_uri" value="/2017/08/17/using-expect-bash/" style="display: none;">&nbsp;</div> <div id="page_title" value="Using Expect with Bash" style="display: none;">&nbsp;</div> <div id="disqus_thread"></div> <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript> <script type="text/javascript" src="/assets/js/disqus.js"></script> <nav class="pagination"> <a href="http://localhost:4000/2017/08/16/iot-simulator-deployment-scenario/" class="pagination_pager" title="IoT Simulator Deployment Scenario ">previous</a> <a href="http://localhost:4000/2017/08/18/docker-image-net-node-core/" class="pagination_pager" title="Docker Windows Image for IoT Edge ">next</a> </nav> </div> </div> <!-- JS --> <script src="http://localhost:4000/assets/js/main.min.js"></script> <div class="overlay"> <ul class="projects-menu"> <li style="background:url(http://taylantatli.me/Halve/images/halve-home-image.png) center center no-repeat;"> <a href="http://taylantatli.me/Halve" class="inactive" target="_blank" rel="nofollow external"> <span> Halve Jekyll Theme <br><em>in progress</em> </span> </a> </li> <li style="background:url(https://cloud.githubusercontent.com/assets/754514/14509720/61c61058-01d6-11e6-93ab-0918515ecd56.png) center center no-repeat;"> <a href="http://taylantatli.me/Moon" target="_blank" rel="nofollow external"> <span> Moon Jekyll Theme </span> </a> </li> <li style="background:url(https://raw.githubusercontent.com/TaylanTatli/Ramme/master/assets/img/screenshot-post.png) center center no-repeat;"> <a href="http://taylantatli.me/Ramme" target="_blank" rel="nofollow external"> <span> Ramme Jekyll Theme </span> </a> </li> <li style="background:url(https://raw.githubusercontent.com/TaylanTatli/Daisy-Pelican-Theme/master/Preview-1.png) center center no-repeat;"> <a href="http://taylantatli.me/Daisy-Pelican-Theme/" target="_blank" rel="nofollow external"> <span> Daisy Pelican Theme </span> </a> </li> <li style="background:url(https://raw.githubusercontent.com/TaylanTatli/Block-Icon-Theme/master/Preview.png) center center no-repeat;"> <a href="https://github.com/TaylanTatli/Block-Icon-Theme" class="inactive" target="_blank" rel="nofollow external"> <span> Block Icon Theme <br><em>in progress</em> </span> </a> </li> <li style="background:url(https://raw.githubusercontent.com/TaylanTatli/StartPage/master/preview.png) center center no-repeat;"> <a href="http://taylantatli.me/StartPage/" class="inactive" target="_blank" rel="nofollow external"> <span> Start Page <br><em>in progress</em> </span> </a> </li> </ul> </div> </body> </html>
