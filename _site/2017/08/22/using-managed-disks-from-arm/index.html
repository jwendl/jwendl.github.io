<!DOCTYPE html> <html> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no"> <title>Creating Managed Disks from Template &#8211; Justin Wendlandt's Blog</title> <meta name="description" content="Most of the templates on the Azure Quick Start GitHub repository are using storage accounts rather than managed disks at the moment (including the Service Fabric cluster one). Here is what you would need to change in order to move over to managed disks instead of regular storage accounts.­First, we would want to remove any references to the storage account(s) so that we can clean up properties that are not needed for Storage Accounts.Secondly, we want to add / change the “osDisk” property of the VM Scale Set to the below, removing other properties in the “osDisk” property. &quot;osDisk&quot;: { &quot;createOption&quot;: &quot;FromImage&quot;, &quot;managedDisk&quot;: { &quot;storageAccountType&quot;: &quot;Premium_LRS&quot; } }, &quot;dataDisks&quot;: [ { &quot;lun&quot;: 1, &quot;createOption&quot;: &quot;Empty&quot;, &quot;diskSizeGB&quot;: 512, &quot;managedDisk&quot;: { &quot;storageAccountType&quot;: &quot;Premium_LRS&quot; } } ] }Additionally, we want to change the Api Version for the VM Scale Set to be 2016-03-30 or later.After the three above changes, the VM Scale Set should be configured properly to use Managed Disks.References: Migrating Azure VMs to Managed Disks in Azure Migrating ARM Template"> <meta name="keywords" content="azure, arm, template"> <!-- Twitter Cards --> <meta name="twitter:card" content="summary"> <meta name="twitter:image" content="halve.png"> <meta name="twitter:title" content="Creating Managed Disks from Template"> <meta name="twitter:description" content="Most of the templates on the Azure Quick Start GitHub repository are using storage accounts rather than managed disks at the moment (including the Service Fabric cluster one). Here is what you would need to change in order to move over to managed disks instead of regular storage accounts.­First, we would want to remove any references to the storage account(s) so that we can clean up properties that are not needed for Storage Accounts.Secondly, we want to add / change the “osDisk” property of the VM Scale Set to the below, removing other properties in the “osDisk” property. &quot;osDisk&quot;: { &quot;createOption&quot;: &quot;FromImage&quot;, &quot;managedDisk&quot;: { &quot;storageAccountType&quot;: &quot;Premium_LRS&quot; } }, &quot;dataDisks&quot;: [ { &quot;lun&quot;: 1, &quot;createOption&quot;: &quot;Empty&quot;, &quot;diskSizeGB&quot;: 512, &quot;managedDisk&quot;: { &quot;storageAccountType&quot;: &quot;Premium_LRS&quot; } } ] }Additionally, we want to change the Api Version for the VM Scale Set to be 2016-03-30 or later.After the three above changes, the VM Scale Set should be configured properly to use Managed Disks.References: Migrating Azure VMs to Managed Disks in Azure Migrating ARM Template"> <meta name="twitter:site" content="@jwendl"> <meta name="twitter:creator" content="@jwendl"> <!-- Open Graph --> <meta property="og:locale" content="en_US"> <meta property="og:type" content="article"> <meta property="og:title" content="Creating Managed Disks from Template"> <meta property="og:description" content="Most of the templates on the Azure Quick Start GitHub repository are using storage accounts rather than managed disks at the moment (including the Service Fabric cluster one). Here is what you would need to change in order to move over to managed disks instead of regular storage accounts.­First, we would want to remove any references to the storage account(s) so that we can clean up properties that are not needed for Storage Accounts.Secondly, we want to add / change the “osDisk” property of the VM Scale Set to the below, removing other properties in the “osDisk” property. &quot;osDisk&quot;: { &quot;createOption&quot;: &quot;FromImage&quot;, &quot;managedDisk&quot;: { &quot;storageAccountType&quot;: &quot;Premium_LRS&quot; } }, &quot;dataDisks&quot;: [ { &quot;lun&quot;: 1, &quot;createOption&quot;: &quot;Empty&quot;, &quot;diskSizeGB&quot;: 512, &quot;managedDisk&quot;: { &quot;storageAccountType&quot;: &quot;Premium_LRS&quot; } } ] }Additionally, we want to change the Api Version for the VM Scale Set to be 2016-03-30 or later.After the three above changes, the VM Scale Set should be configured properly to use Managed Disks.References: Migrating Azure VMs to Managed Disks in Azure Migrating ARM Template"> <meta property="og:url" content="http://localhost:4000/2017/08/22/using-managed-disks-from-arm/"> <meta property="og:site_name" content="Justin Wendlandt's Blog"> <meta property="og:image" content="http://localhost:4000/images/halve.png"> <link rel="canonical" href="http://localhost:4000/2017/08/22/using-managed-disks-from-arm/"> <!-- Handheld --> <meta name="HandheldFriendly" content="True"> <meta name="MobileOptimized" content="320"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- Feed --> <link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Justin Wendlandt's Blog" /> <!-- Favicons --> <link rel="shortcut icon" type="image/png" href="http://localhost:4000/favicon.png" /> <link rel="shortcut icon" href="http://localhost:4000/favicon.ico" /> <!-- CSS --> <link rel="stylesheet" type="text/css" href="http://localhost:4000/assets/css/main.css"> <!-- Left Block Image for Posts --> <style type="text/css"> #posts.inner-post-page .block-left {background: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url(http://localhost:4000/images/unsplash-gallery-image-3.jpg) no-repeat;background-size: cover;} </style> <!-- Left Block Images for Home and Pages --> <style type="text/css"> #posts .block-left {background: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url(http://localhost:4000/images/unsplash-image-10.jpg) no-repeat;background-size: cover, cover;} .block-left {background: linear-gradient(rgba(44,45,51,0.9), rgba(44,45,51,0.9)), url(http://localhost:4000/images/home.png) no-repeat;background-size: cover;} </style> </head> <body id="posts" class="inner-post-page"> <div class="block-left"> <div class="content"> <a href="http://localhost:4000" class="logo"><img src="http://localhost:4000/images/halve.png"></a> <div class="post-title-section"> <div class="section-line">Posts <em>/</em></div> <h1 class="section-title">Creating Managed Disks from Template </h1> <ul class="tags"> <li><a href="http://localhost:4000/tags#azure">azure</a></li> <li><a href="http://localhost:4000/tags#arm">arm</a></li> <li><a href="http://localhost:4000/tags#template">template</a></li> </ul> <div class="section-line reverse"><a href="http://localhost:4000/posts">Back to posts</a> <em>/</em></div> </div> </div> </div> <div class="block-right"> <div class="share-buttons"> <a href="https://twitter.com/intent/tweet?text=http://localhost:4000/2017/08/22/using-managed-disks-from-arm/" class="btn btn_twitter" title="Share on Twitter"><i class="fa fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a> <a href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:4000/2017/08/22/using-managed-disks-from-arm/" class="btn btn_facebook" title="Share on Facebook"><i class="fa fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a> <a href="https://plus.google.com/share?url=http://localhost:4000/2017/08/22/using-managed-disks-from-arm/" class="btn btn_google-plus" title="Share on Google Plus"><i class="fa fa-fw fa-google-plus" aria-hidden="true"></i><span> Google+</span></a> </div> <a href="http://localhost:4000/posts.html" title="posts" class="posts-menu-icon"></a> <a title="http://localhost:4000/projects" class="projects-menu-icon"> <span></span> </a> <div class="inner-post content"> <div class="date-highlight">22 Aug 2017</div> <p>Most of the templates on the <a href="https://github.com/Azure/azure-quickstart-templates">Azure Quick Start</a> GitHub repository are using storage accounts rather than managed disks at the moment (including the Service Fabric cluster one). Here is what you would need to change in order to move over to managed disks instead of regular storage accounts. ­</p> <p>First, we would want to remove any references to the storage account(s) so that we can clean up properties that are not needed for Storage Accounts.</p> <p>Secondly, we want to add / change the “osDisk” property of the VM Scale Set to the below, removing other properties in the “osDisk” property.</p> <figure class="highlight"><pre><code class="language-json" data-lang="json"><span class="w">            </span><span class="s2">"osDisk"</span><span class="err">:</span><span class="w"> </span><span class="p">{</span><span class="w">
              </span><span class="nt">"createOption"</span><span class="p">:</span><span class="w"> </span><span class="s2">"FromImage"</span><span class="p">,</span><span class="w">
              </span><span class="nt">"managedDisk"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">"storageAccountType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Premium_LRS"</span><span class="w"> </span><span class="p">}</span><span class="w">
            </span><span class="p">}</span><span class="err">,</span><span class="w">
            </span><span class="s2">"dataDisks"</span><span class="err">:</span><span class="w"> </span><span class="p">[</span><span class="w">
              </span><span class="p">{</span><span class="w">
                </span><span class="nt">"lun"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
                </span><span class="nt">"createOption"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Empty"</span><span class="p">,</span><span class="w">
                </span><span class="nt">"diskSizeGB"</span><span class="p">:</span><span class="w"> </span><span class="mi">512</span><span class="p">,</span><span class="w">
                </span><span class="nt">"managedDisk"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">"storageAccountType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Premium_LRS"</span><span class="w"> </span><span class="p">}</span><span class="w">
              </span><span class="p">}</span><span class="w">
            </span><span class="p">]</span><span class="w">
          </span><span class="err">}</span></code></pre></figure> <p>Additionally, we want to change the Api Version for the VM Scale Set to be 2016-03-30 or later.</p> <p>After the three above changes, the VM Scale Set should be configured properly to use Managed Disks.</p> <p>References:</p> <ul> <li><a href="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/migrate-to-managed-disks">Migrating Azure VMs to Managed Disks in Azure</a></li> <li><a href="https://github.com/Azure-Samples/resources-dotnet-deploy-virtual-machine-with-managed-disks-using-arm-template/tree/master/Asset">Migrating ARM Template</a></li> </ul> <br /> <a href="https://twitter.com/intent/tweet?text=http://localhost:4000/2017/08/22/using-managed-disks-from-arm/" class="btn btn_twitter" title="Share on Twitter"><i class="fa fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a> <a href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:4000/2017/08/22/using-managed-disks-from-arm/" class="btn btn_facebook" title="Share on Facebook"><i class="fa fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a> <a href="https://plus.google.com/share?url=http://localhost:4000/2017/08/22/using-managed-disks-from-arm/" class="btn btn_google-plus" title="Share on Google Plus"><i class="fa fa-fw fa-google-plus" aria-hidden="true"></i><span> Google+</span></a> <div id="page_uri" value="/2017/08/22/using-managed-disks-from-arm/" style="display: none;">&nbsp;</div> <div id="page_title" value="Creating Managed Disks from Template" style="display: none;">&nbsp;</div> <div id="disqus_thread"></div> <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript> <script type="text/javascript" src="/assets/js/disqus.js"></script> <nav class="pagination"> <a href="http://localhost:4000/2017/08/21/service-fabric-windows-containers/" class="pagination_pager" title="Service Fabric with Windows Containers ">previous</a> <a href="http://localhost:4000/2017/09/05/duplicate-properties-template/" class="pagination_pager" title="Duplicate Properties in Arm Templates ">next</a> </nav> </div> </div> <!-- JS --> <script src="http://localhost:4000/assets/js/main.min.js"></script> <div class="overlay"> <ul class="projects-menu"> <li style="background:url(http://taylantatli.me/Halve/images/halve-home-image.png) center center no-repeat;"> <a href="http://taylantatli.me/Halve" class="inactive" target="_blank" rel="nofollow external"> <span> Halve Jekyll Theme <br><em>in progress</em> </span> </a> </li> <li style="background:url(https://cloud.githubusercontent.com/assets/754514/14509720/61c61058-01d6-11e6-93ab-0918515ecd56.png) center center no-repeat;"> <a href="http://taylantatli.me/Moon" target="_blank" rel="nofollow external"> <span> Moon Jekyll Theme </span> </a> </li> <li style="background:url(https://raw.githubusercontent.com/TaylanTatli/Ramme/master/assets/img/screenshot-post.png) center center no-repeat;"> <a href="http://taylantatli.me/Ramme" target="_blank" rel="nofollow external"> <span> Ramme Jekyll Theme </span> </a> </li> <li style="background:url(https://raw.githubusercontent.com/TaylanTatli/Daisy-Pelican-Theme/master/Preview-1.png) center center no-repeat;"> <a href="http://taylantatli.me/Daisy-Pelican-Theme/" target="_blank" rel="nofollow external"> <span> Daisy Pelican Theme </span> </a> </li> <li style="background:url(https://raw.githubusercontent.com/TaylanTatli/Block-Icon-Theme/master/Preview.png) center center no-repeat;"> <a href="https://github.com/TaylanTatli/Block-Icon-Theme" class="inactive" target="_blank" rel="nofollow external"> <span> Block Icon Theme <br><em>in progress</em> </span> </a> </li> <li style="background:url(https://raw.githubusercontent.com/TaylanTatli/StartPage/master/preview.png) center center no-repeat;"> <a href="http://taylantatli.me/StartPage/" class="inactive" target="_blank" rel="nofollow external"> <span> Start Page <br><em>in progress</em> </span> </a> </li> </ul> </div> </body> </html>
